{
  "config": {
    "max_epochs": 20,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 240,
    "monitor_accumulation_wait": 5,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "containers_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "results_dir": "./benchmark/benchmark_results",
    "dir_name": "test_2",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1761065762.4363964,
  "end_time": 1761066460.4181523,
  "total_epochs": 18,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1761065762.4363964,
      "end_time": 1761065794.5367467,
      "phase_timings": {
        "initialization": 1761065762.4364285,
        "attack_execution": 1761065762.4593801,
        "monitoring_accumulation": 1761065780.74631,
        "agent_analysis": 1761065785.7476754,
        "firewall_update_wait": 1761065792.51968,
        "metrics_collection": 1761065794.5204449,
        "epoch_complete": 1761065794.5359862
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.5 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.5 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 0,
        "epoch": 1
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1761065795.5405433,
      "end_time": 1761065826.8648076,
      "phase_timings": {
        "initialization": 1761065795.5405583,
        "attack_execution": 1761065795.5563412,
        "monitoring_accumulation": 1761065810.9404137,
        "agent_analysis": 1761065815.9417598,
        "firewall_update_wait": 1761065824.852593,
        "metrics_collection": 1761065826.8544135,
        "epoch_complete": 1761065826.8642056
      },
      "services_detected": [
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 25,
        "epoch": 2
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 0,
          "level_new": 25,
          "changed": true,
          "evidence_quotes": [
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1761065827.8683484,
      "end_time": 1761065858.8670852,
      "phase_timings": {
        "initialization": 1761065827.8683589,
        "attack_execution": 1761065827.8788722,
        "monitoring_accumulation": 1761065843.2720373,
        "agent_analysis": 1761065848.2731977,
        "firewall_update_wait": 1761065856.8563943,
        "metrics_collection": 1761065858.8571975,
        "epoch_complete": 1761065858.866481
      },
      "services_detected": [
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.8 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.8 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.5           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.5"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.8",
        "service": "cve-2024-36401-web-1",
        "current_level": 0,
        "epoch": 3
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1761065859.870072,
      "end_time": 1761065891.3820662,
      "phase_timings": {
        "initialization": 1761065859.8700826,
        "attack_execution": 1761065859.8781123,
        "monitoring_accumulation": 1761065875.247204,
        "agent_analysis": 1761065880.2482457,
        "firewall_update_wait": 1761065889.3683896,
        "metrics_collection": 1761065891.369306,
        "epoch_complete": 1761065891.3801796
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.8:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.8",
        "service": "cve-2024-36401-web-1",
        "current_level": 25,
        "epoch": 4
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1761065892.3854058,
      "end_time": 1761065923.5049672,
      "phase_timings": {
        "initialization": 1761065892.3854175,
        "attack_execution": 1761065892.3950741,
        "monitoring_accumulation": 1761065907.8246062,
        "agent_analysis": 1761065912.8256536,
        "firewall_update_wait": 1761065921.4916663,
        "metrics_collection": 1761065923.4933577,
        "epoch_complete": 1761065923.504225
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.8:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.30 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.30 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.8           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.8"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.30",
        "service": "cve-2013-4547-nginx-1",
        "current_level": 0,
        "epoch": 5
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 6,
      "start_time": 1761065924.5104039,
      "end_time": 1761065963.434329,
      "phase_timings": {
        "initialization": 1761065924.5104141,
        "attack_execution": 1761065924.5198917,
        "monitoring_accumulation": 1761065939.8679528,
        "agent_analysis": 1761065944.868925,
        "firewall_update_wait": 1761065961.4147525,
        "metrics_collection": 1761065963.4162376,
        "epoch_complete": 1761065963.4329734
      },
      "services_detected": [
        "HTTP(172.20.0.30:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.4 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.30          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.30"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 0,
        "epoch": 6
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 7,
      "start_time": 1761065964.4390612,
      "end_time": 1761065998.8013651,
      "phase_timings": {
        "initialization": 1761065964.439075,
        "attack_execution": 1761065964.4525464,
        "monitoring_accumulation": 1761065980.2188473,
        "agent_analysis": 1761065985.219743,
        "firewall_update_wait": 1761065996.7862966,
        "metrics_collection": 1761065998.7873394,
        "epoch_complete": 1761065998.800522
      },
      "services_detected": [
        "UNKNOWN(172.20.0.4:61616)",
        "PATROL-SNMP(172.20.0.4:8161)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 25,
        "epoch": 7
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 0,
          "level_new": 25,
          "changed": true,
          "evidence_quotes": [
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 8,
      "start_time": 1761065999.8057082,
      "end_time": 1761066034.637747,
      "phase_timings": {
        "initialization": 1761065999.8057206,
        "attack_execution": 1761065999.8186634,
        "monitoring_accumulation": 1761066015.4183962,
        "agent_analysis": 1761066020.419452,
        "firewall_update_wait": 1761066032.6246994,
        "metrics_collection": 1761066034.62591,
        "epoch_complete": 1761066034.6371002
      },
      "services_detected": [
        "UNKNOWN(172.20.0.4:61616)",
        "PATROL-SNMP(172.20.0.4:8161)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.8 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.8 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.4           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.4"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.8",
        "service": "cve-2024-36401-web-1",
        "current_level": 25,
        "epoch": 8
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 9,
      "start_time": 1761066035.640732,
      "end_time": 1761066075.8710356,
      "phase_timings": {
        "initialization": 1761066035.6407454,
        "attack_execution": 1761066035.6518004,
        "monitoring_accumulation": 1761066051.0753531,
        "agent_analysis": 1761066056.0759933,
        "firewall_update_wait": 1761066073.8579516,
        "metrics_collection": 1761066075.8590484,
        "epoch_complete": 1761066075.870141
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.8:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.8           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.8"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 0,
        "epoch": 9
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 10,
      "start_time": 1761066076.8747723,
      "end_time": 1761066121.782781,
      "phase_timings": {
        "initialization": 1761066076.874783,
        "attack_execution": 1761066076.8873317,
        "monitoring_accumulation": 1761066099.9421628,
        "agent_analysis": 1761066104.9428594,
        "firewall_update_wait": 1761066119.7684994,
        "metrics_collection": 1761066121.7695596,
        "epoch_complete": 1761066121.7819242
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 25,
        "epoch": 10
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 25,
          "changed": true,
          "evidence_quotes": [
            "ET INFO POSSIBLE Web Crawl using Curl"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 10,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 11,
      "start_time": 1761066122.785779,
      "end_time": 1761066168.6841464,
      "phase_timings": {
        "initialization": 1761066122.7857938,
        "attack_execution": 1761066122.796479,
        "monitoring_accumulation": 1761066150.7652617,
        "agent_analysis": 1761066155.7660506,
        "firewall_update_wait": 1761066166.6667187,
        "metrics_collection": 1761066168.6690755,
        "epoch_complete": 1761066168.6830802
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 75,
        "epoch": 11
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 25,
          "level_new": 75,
          "changed": true,
          "evidence_quotes": [
            "User-Level File Discovery"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 10,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 12,
      "start_time": 1761066169.691107,
      "end_time": 1761066227.5222437,
      "phase_timings": {
        "initialization": 1761066169.6911223,
        "attack_execution": 1761066169.7052076,
        "monitoring_accumulation": 1761066206.2976162,
        "agent_analysis": 1761066211.299281,
        "firewall_update_wait": 1761066225.5082178,
        "metrics_collection": 1761066227.509433,
        "epoch_complete": 1761066227.5215518
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        },
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 0,
        "epoch": 12
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 75,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Root-Level File Access"
          ]
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 10,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 13,
      "start_time": 1761066228.5271792,
      "end_time": 1761066265.7547483,
      "phase_timings": {
        "initialization": 1761066228.5272124,
        "attack_execution": 1761066228.539868,
        "monitoring_accumulation": 1761066247.7569287,
        "agent_analysis": 1761066252.7582355,
        "firewall_update_wait": 1761066263.7426348,
        "metrics_collection": 1761066265.7440925,
        "epoch_complete": 1761066265.753897
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 50,
        "epoch": 13
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 50,
          "changed": true,
          "evidence_quotes": [
            "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
          ]
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 13,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 14,
      "start_time": 1761066266.758394,
      "end_time": 1761066312.59157,
      "phase_timings": {
        "initialization": 1761066266.7584114,
        "attack_execution": 1761066266.7785616,
        "monitoring_accumulation": 1761066290.2970963,
        "agent_analysis": 1761066295.2979784,
        "firewall_update_wait": 1761066310.5814931,
        "metrics_collection": 1761066312.5824258,
        "epoch_complete": 1761066312.5910919
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.30 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.30 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.30",
        "service": "cve-2013-4547-nginx-1",
        "current_level": 25,
        "epoch": 14
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 13,
          "local_epoch": 2,
          "allowed_phase": "data-exfil"
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 15,
      "start_time": 1761066313.5945735,
      "end_time": 1761066347.9466188,
      "phase_timings": {
        "initialization": 1761066313.5945823,
        "attack_execution": 1761066313.6025286,
        "monitoring_accumulation": 1761066328.9718893,
        "agent_analysis": 1761066333.9727457,
        "firewall_update_wait": 1761066345.935262,
        "metrics_collection": 1761066347.9364066,
        "epoch_complete": 1761066347.9458091
      },
      "services_detected": [
        "HTTP(172.20.0.30:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.4 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.4 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.30          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.30"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "current_level": 25,
        "epoch": 15
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 16,
      "start_time": 1761066348.9508011,
      "end_time": 1761066387.5671535,
      "phase_timings": {
        "initialization": 1761066348.9508135,
        "attack_execution": 1761066348.9615598,
        "monitoring_accumulation": 1761066364.6093838,
        "agent_analysis": 1761066369.6102374,
        "firewall_update_wait": 1761066385.5545776,
        "metrics_collection": 1761066387.5554519,
        "epoch_complete": 1761066387.5666015
      },
      "services_detected": [
        "UNKNOWN(172.20.0.4:61616)",
        "PATROL-SNMP(172.20.0.4:8161)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.30 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.30 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.4           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.4"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.30",
        "service": "cve-2013-4547-nginx-1",
        "current_level": 25,
        "epoch": 16
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 17,
      "start_time": 1761066388.571447,
      "end_time": 1761066428.2306345,
      "phase_timings": {
        "initialization": 1761066388.571468,
        "attack_execution": 1761066388.5842996,
        "monitoring_accumulation": 1761066403.9505677,
        "agent_analysis": 1761066408.9515696,
        "firewall_update_wait": 1761066426.2107115,
        "metrics_collection": 1761066428.2127526,
        "epoch_complete": 1761066428.2299073
      },
      "services_detected": [
        "HTTP(172.20.0.30:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.5 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.5 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.30          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.30"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "current_level": 25,
        "epoch": 17
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "cat /root/root.txt"
          ]
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "inferred from later phase: cat /root/root.txt"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 18,
      "start_time": 1761066429.2347922,
      "end_time": 1761066460.4181523,
      "phase_timings": {
        "initialization": 1761066429.2348032,
        "attack_execution": 1761066429.2448454,
        "monitoring_accumulation": 1761066444.5999918,
        "agent_analysis": 1761066449.600753,
        "firewall_update_wait": 1761066458.405829,
        "metrics_collection": 1761066460.4073517,
        "epoch_complete": 1761066460.4175014
      },
      "services_detected": [
        "HTTP(172.20.0.5:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "",
        "service": "",
        "current_level": 0,
        "epoch": 18
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.8",
          "service": "cve-2024-36401-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.30",
          "service": "cve-2013-4547-nginx-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.5",
          "service": "cve-2014-6271-web-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.4",
          "service": "cve-2015-5254-activemq-1",
          "level_prev": 25,
          "level_new": 25,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.5",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.8",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.30",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.4",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET INFO POSSIBLE Web Crawl using Curl",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "inferred from later phase: cat /root/root.txt"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          }
        ]
      },
      "service_epoch_context": [],
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 4,
    "average_epoch_duration": 37.82848232322269,
    "lockdown_triggered": true,
    "lockdown_epoch": 18,
    "final_containers_exploitation": [
      {
        "ip": "172.20.0.8",
        "service": "cve-2024-36401-web-1",
        "level_prev": 25,
        "level_new": 25,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.30",
        "service": "cve-2013-4547-nginx-1",
        "level_prev": 25,
        "level_new": 25,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.5",
        "service": "cve-2014-6271-web-1",
        "level_prev": 25,
        "level_new": 25,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.4",
        "service": "cve-2015-5254-activemq-1",
        "level_prev": 25,
        "level_new": 25,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      }
    ],
    "final_inferred_attack_graph": {
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.5",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to MSSQL port 1433",
                "ET SCAN Suspicious inbound to mySQL port 3306",
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            }
          ],
          "current_phase": "scan",
          "vector": "scan"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.8",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to MSSQL port 1433",
                "ET SCAN Suspicious inbound to mySQL port 3306",
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            }
          ],
          "current_phase": "scan",
          "vector": "scan"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.30",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to MSSQL port 1433",
                "ET SCAN Suspicious inbound to mySQL port 3306",
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            }
          ],
          "current_phase": "scan",
          "vector": "scan"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.4",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to MSSQL port 1433",
                "ET SCAN Suspicious inbound to mySQL port 3306",
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            }
          ],
          "current_phase": "scan",
          "vector": "scan"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET INFO POSSIBLE Web Crawl using Curl",
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
              ]
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "User-Level File Discovery",
                "cat /home/ctf/user.txt"
              ]
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "Privilege Escalation Attempt - bash -p",
                "/bin/bash -p"
              ]
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "Root-Level File Access",
                "cat /root/root.txt"
              ]
            }
          ],
          "current_phase": "data-exfil-root",
          "vector": "data-exfil-root"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.3",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
              ]
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity"
              ]
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "inferred from later phase: cat /root/root.txt"
              ]
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "cat /root/root.txt"
              ]
            }
          ],
          "current_phase": "data-exfil-root",
          "vector": "data-exfil-root"
        }
      ],
      "interesting": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy"
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1"
        }
      ]
    }
  }
}