{
  "config": {
    "max_epochs": 20,
    "attacker_image": "attacker:latest",
    "attacker_container_name": "attackercontainer-attacker",
    "attack_duration": 240,
    "monitor_accumulation_wait": 5,
    "firewall_update_wait": 2,
    "between_epoch_wait": 1,
    "attacker_network": "192.168.100.0/24",
    "containers_network": "172.20.0.0/24",
    "firewall_api_url": "http://192.168.200.2:5000",
    "allow_full_compromise": true,
    "stop_on_lockdown": true,
    "clear_memory_between_epochs": false,
    "mode": "deterministic",
    "results_dir": "./benchmark/benchmark_results",
    "dir_name": "test_3",
    "save_detailed_logs": true,
    "log_level": "INFO"
  },
  "start_time": 1762105558.486954,
  "end_time": 1762106158.4301736,
  "total_epochs": 13,
  "epochs": [
    {
      "epoch_number": 1,
      "start_time": 1762105558.486954,
      "end_time": 1762105591.4933853,
      "phase_timings": {
        "initialization": 1762105558.486981,
        "attack_execution": 1762105558.5044487,
        "monitoring_accumulation": 1762105575.4928,
        "agent_analysis": 1762105580.4936647,
        "firewall_update_wait": 1762105589.4629724,
        "metrics_collection": 1762105591.464839,
        "epoch_complete": 1762105591.4922354
      },
      "services_detected": [],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 0,
        "epoch": 1
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [],
        "interesting": []
      },
      "service_epoch_context": [],
      "lockdown_activated": false
    },
    {
      "epoch_number": 2,
      "start_time": 1762105592.498006,
      "end_time": 1762105627.7212675,
      "phase_timings": {
        "initialization": 1762105592.4980233,
        "attack_execution": 1762105592.5115347,
        "monitoring_accumulation": 1762105610.9003189,
        "agent_analysis": 1762105615.9014623,
        "firewall_update_wait": 1762105625.6972785,
        "metrics_collection": 1762105627.6999474,
        "epoch_complete": 1762105627.7202475
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 25,
        "epoch": 2
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 0,
          "level_new": 25,
          "changed": true,
          "evidence_quotes": [
            "ET SCAN Suspicious inbound to MSSQL port 1433"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": []
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 3,
      "start_time": 1762105628.7265747,
      "end_time": 1762105674.4175303,
      "phase_timings": {
        "initialization": 1762105628.7265844,
        "attack_execution": 1762105628.7399685,
        "monitoring_accumulation": 1762105657.6330454,
        "agent_analysis": 1762105662.635526,
        "firewall_update_wait": 1762105672.4055464,
        "metrics_collection": 1762105674.4065301,
        "epoch_complete": 1762105674.4168286
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 75,
        "epoch": 3
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 25,
          "level_new": 75,
          "changed": true,
          "evidence_quotes": [
            "User-Level File Discovery"
          ]
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 2,
          "allowed_phase": "data-exfil",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 4,
      "start_time": 1762105675.4233916,
      "end_time": 1762105717.2074566,
      "phase_timings": {
        "initialization": 1762105675.4234064,
        "attack_execution": 1762105675.4376562,
        "monitoring_accumulation": 1762105701.664994,
        "agent_analysis": 1762105706.6657805,
        "firewall_update_wait": 1762105715.1915333,
        "metrics_collection": 1762105717.1933398,
        "epoch_complete": 1762105717.2064984
      },
      "services_detected": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "services_successfully_exploited": [
        "DOCKER"
      ],
      "exploits_attempted": [
        "DOCKER(172.20.0.2:2375)"
      ],
      "flags_captured": [
        {
          "service": "DOCKER",
          "flag": "flag{docker}"
        }
      ],
      "attack_success_rate": 100.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.2           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.2"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 0,
        "epoch": 4
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "docker:172.20.0.2:2375",
          "service": "docker",
          "host": "172.20.0.2",
          "port": "2375",
          "first_exposed_epoch": 2,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 5,
      "start_time": 1762105718.2120047,
      "end_time": 1762105759.0037224,
      "phase_timings": {
        "initialization": 1762105718.2120237,
        "attack_execution": 1762105718.2248154,
        "monitoring_accumulation": 1762105735.9896684,
        "agent_analysis": 1762105740.991199,
        "firewall_update_wait": 1762105756.9891577,
        "metrics_collection": 1762105758.9902508,
        "epoch_complete": 1762105759.0031245
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 50,
        "epoch": 5
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 5,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 6,
      "start_time": 1762105760.0075622,
      "end_time": 1762105806.875692,
      "phase_timings": {
        "initialization": 1762105760.0075724,
        "attack_execution": 1762105760.0192773,
        "monitoring_accumulation": 1762105783.6446228,
        "agent_analysis": 1762105788.6458817,
        "firewall_update_wait": 1762105804.8614984,
        "metrics_collection": 1762105806.863271,
        "epoch_complete": 1762105806.8749304
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 0,
        "epoch": 6
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 5,
          "local_epoch": 2,
          "allowed_phase": "data-exfil",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 7,
      "start_time": 1762105807.881533,
      "end_time": 1762105850.2393515,
      "phase_timings": {
        "initialization": 1762105807.8815498,
        "attack_execution": 1762105807.8914728,
        "monitoring_accumulation": 1762105829.5262952,
        "agent_analysis": 1762105834.5274112,
        "firewall_update_wait": 1762105848.2272441,
        "metrics_collection": 1762105850.2283084,
        "epoch_complete": 1762105850.2387133
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 50,
        "epoch": 7
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 7,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 8,
      "start_time": 1762105851.2420201,
      "end_time": 1762105902.7219918,
      "phase_timings": {
        "initialization": 1762105851.2420304,
        "attack_execution": 1762105851.252659,
        "monitoring_accumulation": 1762105878.9416773,
        "agent_analysis": 1762105883.9427717,
        "firewall_update_wait": 1762105900.7091486,
        "metrics_collection": 1762105902.7103648,
        "epoch_complete": 1762105902.721285
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.7 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.7 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 0,
        "epoch": 8
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 0,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 7,
          "local_epoch": 2,
          "allowed_phase": "data-exfil",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 9,
      "start_time": 1762105903.726851,
      "end_time": 1762105950.589336,
      "phase_timings": {
        "initialization": 1762105903.7268617,
        "attack_execution": 1762105903.7373073,
        "monitoring_accumulation": 1762105934.4606142,
        "agent_analysis": 1762105939.4625444,
        "firewall_update_wait": 1762105948.5771837,
        "metrics_collection": 1762105950.5786793,
        "epoch_complete": 1762105950.5887618
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [],
      "exploits_attempted": [],
      "flags_captured": [],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 25,
        "epoch": 9
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 0,
          "level_new": 25,
          "changed": true,
          "evidence_quotes": [
            "POSSBL PORT SCAN (NMAP -sS)"
          ]
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              }
            ],
            "current_phase": "scan",
            "vector": "scan"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 9,
          "local_epoch": 1,
          "allowed_phase": "initial-access/rce",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 10,
      "start_time": 1762105951.5935845,
      "end_time": 1762105997.7477171,
      "phase_timings": {
        "initialization": 1762105951.5935943,
        "attack_execution": 1762105951.604622,
        "monitoring_accumulation": 1762105982.304644,
        "agent_analysis": 1762105987.3056664,
        "firewall_update_wait": 1762105995.7297442,
        "metrics_collection": 1762105997.7312925,
        "epoch_complete": 1762105997.7465167
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [
        "PHP"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "PHP",
          "flag": "flag{user_access_php}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [],
      "firewall_rules_removed": [],
      "selected_container": {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "current_level": 75,
        "epoch": 10
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 25,
          "level_new": 75,
          "changed": true,
          "evidence_quotes": [
            "User-Level File Discovery"
          ]
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/php/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 9,
          "local_epoch": 2,
          "allowed_phase": "data-exfil",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 11,
      "start_time": 1762105998.752316,
      "end_time": 1762106059.4066577,
      "phase_timings": {
        "initialization": 1762105998.7523267,
        "attack_execution": 1762105998.762319,
        "monitoring_accumulation": 1762106037.5375144,
        "agent_analysis": 1762106042.5385394,
        "firewall_update_wait": 1762106057.390881,
        "metrics_collection": 1762106059.3922904,
        "epoch_complete": 1762106059.4055252
      },
      "services_detected": [
        "HTTP(172.20.0.7:80)"
      ],
      "services_successfully_exploited": [
        "PHP"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "PHP",
          "flag": "flag{user_access_php}"
        },
        {
          "service": "PHP",
          "flag": "flag{privileged_access_php}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.3 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.3 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.7           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.7"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "current_level": 50,
        "epoch": 11
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 50,
          "level_new": 50,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 75,
          "level_new": 100,
          "changed": true,
          "evidence_quotes": [
            "Root-Level File Access"
          ]
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              }
            ],
            "current_phase": "initial-access/rce",
            "vector": "initial-access/rce"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/php/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "find . -exec /bin/bash -p \\; -quit"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "debug_php:172.20.0.7:80",
          "service": "debug_php",
          "host": "172.20.0.7",
          "port": "80",
          "path": "http://172.20.0.7:80",
          "first_exposed_epoch": 9,
          "local_epoch": 3,
          "allowed_phase": "privilege_escalation",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 12,
      "start_time": 1762106060.410386,
      "end_time": 1762106100.6741078,
      "phase_timings": {
        "initialization": 1762106060.4103992,
        "attack_execution": 1762106060.4205012,
        "monitoring_accumulation": 1762106084.0596673,
        "agent_analysis": 1762106089.0605624,
        "firewall_update_wait": 1762106098.653477,
        "metrics_collection": 1762106100.6552558,
        "epoch_complete": 1762106100.673384
      },
      "services_detected": [
        "HTTP-PROXY(172.20.0.3:8080)"
      ],
      "services_successfully_exploited": [
        "STRUTS"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "STRUTS",
          "flag": "flag{privileged_access_struts}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.10 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.10 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.3           192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.3"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "current_level": 75,
        "epoch": 12
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "inferred from later phase: Root-Level File Access"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/php/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "find . -exec /bin/bash -p \\; -quit"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "struts:172.20.0.3:8080",
          "service": "struts",
          "host": "172.20.0.3",
          "port": "8080",
          "path": "struts2-showcase",
          "first_exposed_epoch": 5,
          "local_epoch": 8,
          "allowed_phase": "privilege_escalation",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": false
    },
    {
      "epoch_number": 13,
      "start_time": 1762106101.6794572,
      "end_time": 1762106158.4301736,
      "phase_timings": {
        "initialization": 1762106101.6794786,
        "attack_execution": 1762106101.692275,
        "monitoring_accumulation": 1762106138.7124956,
        "agent_analysis": 1762106143.7139118,
        "firewall_update_wait": 1762106156.4174461,
        "metrics_collection": 1762106158.4183316,
        "epoch_complete": 1762106158.4294066
      },
      "services_detected": [
        "HTTP(172.20.0.10:80)"
      ],
      "services_successfully_exploited": [
        "GITLAB"
      ],
      "exploits_attempted": [],
      "flags_captured": [
        {
          "service": "GITLAB",
          "flag": "flag{user_access_gitlab}"
        },
        {
          "service": "GITLAB",
          "flag": "flag{privileged_access_gitlab}"
        }
      ],
      "attack_success_rate": 0.0,
      "firewall_rules_added": [
        {
          "rules_added_current_epoch": "ALLOW 192.168.100.0/24 -> 172.20.0.2 (tcp)"
        },
        {
          "rules_added_current_epoch": "ALLOW 172.20.0.2 -> 192.168.100.0/24 (tcp)"
        }
      ],
      "firewall_rules_removed": [
        {
          "rules_removed_current_epoch": [
            "REMOVED rule #1:    ACCEPT     tcp  --  172.20.0.10          192.168.100.0/24",
            "REMOVED rule #2:    ACCEPT     tcp  --  192.168.100.0/24     172.20.0.10"
          ]
        }
      ],
      "selected_container": {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "current_level": 75,
        "epoch": 13
      },
      "containers_exploitation": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1",
          "level_prev": 75,
          "level_new": 75,
          "changed": false,
          "evidence_quotes": []
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1",
          "level_prev": 100,
          "level_new": 100,
          "changed": false,
          "evidence_quotes": []
        }
      ],
      "inferred_attack_graph": {
        "edges": [
          {
            "from": "192.168.100.2",
            "to": "172.20.0.2",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-user",
            "vector": "data-exfil-user"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.3",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                  "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                  "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                  "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                  "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                  "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "inferred from later phase: Root-Level File Access"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.10",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "ET SCAN Suspicious inbound to MSSQL port 1433",
                  "ET SCAN Suspicious inbound to mySQL port 3306",
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/ctf/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "/bin/bash -p"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          },
          {
            "from": "192.168.100.2",
            "to": "172.20.0.7",
            "phases": [
              {
                "phase": "scan",
                "evidence_quotes": [
                  "POSSBL PORT SCAN (NMAP -sS)"
                ]
              },
              {
                "phase": "initial-access/rce",
                "evidence_quotes": [
                  "inferred from later phase: User-Level File Discovery"
                ]
              },
              {
                "phase": "data-exfil-user",
                "evidence_quotes": [
                  "User-Level File Discovery",
                  "cat /home/php/user.txt"
                ]
              },
              {
                "phase": "privilege-escalation",
                "evidence_quotes": [
                  "Privilege Escalation Attempt - bash -p",
                  "find . -exec /bin/bash -p \\; -quit"
                ]
              },
              {
                "phase": "data-exfil-root",
                "evidence_quotes": [
                  "Root-Level File Access",
                  "cat /root/root.txt"
                ]
              }
            ],
            "current_phase": "data-exfil-root",
            "vector": "data-exfil-root"
          }
        ],
        "interesting": [
          {
            "ip": "172.20.0.10",
            "service": "cve-2021-22205-gitlab-1-proxy"
          },
          {
            "ip": "172.20.0.2",
            "service": "unauthorized-rce-docker-1"
          },
          {
            "ip": "172.20.0.3",
            "service": "s2-057-struts2-1"
          },
          {
            "ip": "172.20.0.7",
            "service": "xdebug-rce-xdebug2-1"
          }
        ]
      },
      "service_epoch_context": [
        {
          "service_id": "gitlab:172.20.0.10:80",
          "service": "gitlab",
          "host": "172.20.0.10",
          "port": "80",
          "url": "http://172.20.0.10:80",
          "version": "13.12.3",
          "first_exposed_epoch": 7,
          "local_epoch": 7,
          "allowed_phase": "privilege_escalation",
          "rotation_attempt_prob": 1,
          "attempted": true
        }
      ],
      "lockdown_activated": true
    }
  ],
  "summary": {
    "total_flags_captured": 10,
    "average_epoch_duration": 45.22213449844947,
    "lockdown_triggered": true,
    "lockdown_epoch": 13,
    "final_containers_exploitation": [
      {
        "ip": "172.20.0.10",
        "service": "cve-2021-22205-gitlab-1-proxy",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.3",
        "service": "s2-057-struts2-1",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.2",
        "service": "unauthorized-rce-docker-1",
        "level_prev": 75,
        "level_new": 75,
        "changed": false,
        "evidence_quotes": []
      },
      {
        "ip": "172.20.0.7",
        "service": "xdebug-rce-xdebug2-1",
        "level_prev": 100,
        "level_new": 100,
        "changed": false,
        "evidence_quotes": []
      }
    ],
    "final_inferred_attack_graph": {
      "edges": [
        {
          "from": "192.168.100.2",
          "to": "172.20.0.2",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to MSSQL port 1433",
                "ET SCAN Suspicious inbound to mySQL port 3306",
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "inferred from later phase: User-Level File Discovery"
              ]
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "User-Level File Discovery",
                "cat /home/ctf/user.txt"
              ]
            }
          ],
          "current_phase": "data-exfil-user",
          "vector": "data-exfil-user"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.3",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "inferred from later phase: ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI"
              ]
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET EXPLOIT Apache Struts Possible OGNL Java Exec In URI",
                "ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action",
                "ET WEB_SPECIFIC_APPS Apache Struts java.lang inbound OGNL injection remote code execution attempt",
                "ET WEB_SPECIFIC_APPS Apache Struts ognl inbound OGNL injection remote code execution attempt",
                "ET HUNTING .exec in HTTP URI Inbound - Possible Exploit Activity",
                "GET /struts2-showcase/%24%7B%0A%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D%40java.lang.Runtime%40getRuntim"
              ]
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "inferred from later phase: Root-Level File Access"
              ]
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "Root-Level File Access",
                "cat /root/root.txt"
              ]
            }
          ],
          "current_phase": "data-exfil-root",
          "vector": "data-exfil-root"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.10",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "ET SCAN Suspicious inbound to MSSQL port 1433",
                "ET SCAN Suspicious inbound to mySQL port 3306",
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer M3"
              ]
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "User-Level File Discovery",
                "cat /home/ctf/user.txt"
              ]
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "Privilege Escalation Attempt - bash -p",
                "/bin/bash -p"
              ]
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "Root-Level File Access",
                "cat /root/root.txt"
              ]
            }
          ],
          "current_phase": "data-exfil-root",
          "vector": "data-exfil-root"
        },
        {
          "from": "192.168.100.2",
          "to": "172.20.0.7",
          "phases": [
            {
              "phase": "scan",
              "evidence_quotes": [
                "POSSBL PORT SCAN (NMAP -sS)"
              ]
            },
            {
              "phase": "initial-access/rce",
              "evidence_quotes": [
                "inferred from later phase: User-Level File Discovery"
              ]
            },
            {
              "phase": "data-exfil-user",
              "evidence_quotes": [
                "User-Level File Discovery",
                "cat /home/php/user.txt"
              ]
            },
            {
              "phase": "privilege-escalation",
              "evidence_quotes": [
                "Privilege Escalation Attempt - bash -p",
                "find . -exec /bin/bash -p \\; -quit"
              ]
            },
            {
              "phase": "data-exfil-root",
              "evidence_quotes": [
                "Root-Level File Access",
                "cat /root/root.txt"
              ]
            }
          ],
          "current_phase": "data-exfil-root",
          "vector": "data-exfil-root"
        }
      ],
      "interesting": [
        {
          "ip": "172.20.0.10",
          "service": "cve-2021-22205-gitlab-1-proxy"
        },
        {
          "ip": "172.20.0.2",
          "service": "unauthorized-rce-docker-1"
        },
        {
          "ip": "172.20.0.3",
          "service": "s2-057-struts2-1"
        },
        {
          "ip": "172.20.0.7",
          "service": "xdebug-rce-xdebug2-1"
        }
      ]
    }
  }
}